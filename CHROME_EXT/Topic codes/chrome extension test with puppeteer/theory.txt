Here‚Äôs a clean, production-ready folder structure for combining Puppeteer automated tests with a Chrome MV3 extension.

It separates the extension code from the test scripts, making it easier to maintain.

üìÅ Folder Structure
puppeteer-chrome-extension/
‚îÇ
‚îú‚îÄ‚îÄ extension/                 # Your Chrome extension
‚îÇ   ‚îú‚îÄ‚îÄ manifest.json          # MV3 manifest
‚îÇ   ‚îú‚îÄ‚îÄ content.js             # Content script
‚îÇ   ‚îú‚îÄ‚îÄ background/            # Service worker
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ service_worker.js
‚îÇ   ‚îú‚îÄ‚îÄ popup/                 # Optional popup UI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ popup.html
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ popup.js
‚îÇ   ‚îú‚îÄ‚îÄ styles/                # Optional CSS
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shadow.css
‚îÇ   ‚îî‚îÄ‚îÄ icons/
‚îÇ       ‚îî‚îÄ‚îÄ icon128.png
‚îÇ
‚îú‚îÄ‚îÄ tests/                     # Puppeteer automated tests
‚îÇ   ‚îú‚îÄ‚îÄ puppeteer.config.js    # Optional Puppeteer config
‚îÇ   ‚îî‚îÄ‚îÄ extension.test.js      # Test script
‚îÇ
‚îú‚îÄ‚îÄ package.json               # Node project with Puppeteer dependency
‚îî‚îÄ‚îÄ package-lock.json

1Ô∏è‚É£ extension/ Folder

Contains all Chrome extension code:

manifest.json ‚Äì defines permissions, content scripts, service worker, host access

content.js ‚Äì injected UI (e.g., Shadow DOM) or DOM manipulation

background/service_worker.js ‚Äì handles messages, alarms, storage

popup/ ‚Äì optional extension UI

styles/ ‚Äì optional CSS for Shadow DOM

icons/ ‚Äì extension icons

Example manifest.json
{
  "manifest_version": 3,
  "name": "Test Extension",
  "version": "1.0",
  "permissions": ["storage", "activeTab"],
  "host_permissions": ["https://example.com/*"],
  "background": {
    "service_worker": "background/service_worker.js"
  },
  "content_scripts": [
    {
      "matches": ["https://example.com/*"],
      "js": ["content.js"]
    }
  ]
}

2Ô∏è‚É£ tests/ Folder

Contains Puppeteer scripts to launch Chrome and load your extension:

extension.test.js ‚Äì actual test script

Optional puppeteer.config.js ‚Äì to define browser args, timeouts, or globals

Example extension.test.js
const puppeteer = require('puppeteer');
const path = require('path');

(async () => {
  const extensionPath = path.resolve(__dirname, '../extension');

  const browser = await puppeteer.launch({
    headless: false,
    args: [
      `--disable-extensions-except=${extensionPath}`,
      `--load-extension=${extensionPath}`
    ]
  });

  const page = await browser.newPage();
  await page.goto('https://example.com');

  // Access content script DOM (Shadow DOM)
  const result = await page.evaluate(() =>
    document.querySelector('#my-extension-host')?.textContent
  );
  console.log('Content Script Text:', result);

  await browser.close();
})();

3Ô∏è‚É£ package.json

Your Node project file to install Puppeteer:

{
  "name": "puppeteer-chrome-extension",
  "version": "1.0.0",
  "scripts": {
    "test": "node tests/extension.test.js"
  },
  "dependencies": {
    "puppeteer": "^21.3.0"
  }
}


Install dependencies:

npm install


Run tests:

npm test

4Ô∏è‚É£ Notes / Best Practices

Keep extension and tests separate.

Always use relative paths to load your extension in Puppeteer.

Use headless: false ‚Üí extensions cannot load in headless Chrome.

Separate content script testing from service worker testing.

Clean up DOM or storage in tests to avoid state pollution.